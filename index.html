<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> –ê–ò–° ¬´–°–õ–ï–î–û–í–ê–¢–ï–õ–¨¬ª | –ï–¥–∏–Ω—ã–π —Ä–µ–µ—Å—Ç—Ä</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;700&family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-dark: #111827;
            --bg-panel: #1f2937;
            --primary: #2563eb;
            --accent: #ef4444;
            --text-main: #f3f4f6;
            --text-mute: #9ca3af;
            --border: #374151;
            --success: #059669;
        }
        * { box-sizing: border-box; }
        body { margin: 0; font-family: 'Roboto', sans-serif; background: var(--bg-dark); color: var(--text-main); height: 100vh; overflow: hidden; }
        
        /* LOGIN */
        #login-screen { position: fixed; inset: 0; z-index: 9999; background: #0f172a; display: flex; align-items: center; justify-content: center; background-image: radial-gradient(#1e293b 1px, transparent 1px); background-size: 20px 20px; }
        .login-card { background: #1e293b; border: 1px solid var(--border); width: 450px; padding: 40px; box-shadow: 0 25px 50px -12px rgba(0,0,0,0.5); text-align: center; border-top: 4px solid var(--primary); }
        .input-f { width: 100%; background: #111827; border: 1px solid var(--border); color: white; padding: 12px; margin: 10px 0; font-family: 'Roboto Mono', monospace; }
        .btn { width: 100%; padding: 12px; border: none; font-weight: bold; cursor: pointer; text-transform: uppercase; letter-spacing: 1px; transition: 0.2s; }
        .btn-blue { background: var(--primary); color: white; } .btn-blue:hover { background: #1d4ed8; }
        .btn-red { background: var(--accent); color: white; } .btn-red:hover { background: #dc2626; }
        .btn-outline { background: transparent; border: 1px solid var(--border); color: var(--text-mute); }

        /* UI GRID */
        #app { display: none; grid-template-columns: 260px 1fr; grid-template-rows: 60px 1fr; height: 100vh; }
        
        /* HEADER */
        header { grid-column: 1 / 3; background: #111827; border-bottom: 1px solid var(--border); display: flex; align-items: center; justify-content: space-between; padding: 0 20px; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.3); z-index: 10; }
        .brand { font-weight: 700; font-size: 1.1rem; display: flex; align-items: center; gap: 10px; color: var(--primary); }
        .badge { padding: 2px 6px; border-radius: 4px; font-size: 0.7rem; font-weight: bold; }
        .badge-dsp { background: var(--accent); color: white; }

        /* SIDEBAR */
        aside { background: #1f2937; border-right: 1px solid var(--border); overflow-y: auto; display: flex; flex-direction: column; }
        .nav-cat { padding: 20px 20px 5px; font-size: 0.7rem; text-transform: uppercase; color: var(--text-mute); font-weight: bold; letter-spacing: 0.5px; }
        .nav-item { padding: 10px 20px; cursor: pointer; border-left: 3px solid transparent; font-size: 0.9rem; color: #d1d5db; display: flex; align-items: center; gap: 10px; }
        .nav-item:hover { background: #374151; color: white; }
        .nav-item.active { background: #374151; border-left-color: var(--primary); color: white; }

        /* MAIN */
        main { padding: 30px; overflow-y: auto; position: relative; background: #111827; }
        .card { background: #1f2937; border: 1px solid var(--border); padding: 25px; margin-bottom: 20px; border-radius: 4px; }
        h2 { margin-top: 0; color: white; border-bottom: 1px solid var(--border); padding-bottom: 10px; font-size: 1.2rem; display: flex; justify-content: space-between; }
        
        /* TABLES */
        table { width: 100%; border-collapse: collapse; font-size: 0.85rem; }
        th { text-align: left; padding: 12px; background: #111827; color: var(--text-mute); border-bottom: 2px solid var(--border); text-transform: uppercase; font-size: 0.75rem; }
        td { padding: 12px; border-bottom: 1px solid var(--border); color: #e5e7eb; }
        tr:hover { background: #374151; }

        /* MODAL */
        .modal-wrap { position: fixed; inset: 0; background: rgba(0,0,0,0.8); display: none; align-items: center; justify-content: center; z-index: 100; }
        .modal { background: #1f2937; width: 600px; padding: 30px; border: 1px solid var(--border); max-height: 90vh; overflow-y: auto; }
        label { display: block; margin-top: 15px; margin-bottom: 5px; font-size: 0.8rem; color: var(--text-mute); }
    </style>
</head>
<body>

<!-- LOGIN -->
<div id="login-screen">
    <div class="login-card">
        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/c/ca/Emblem_of_the_Investigative_Committee_of_Russia.svg/1200px-Emblem_of_the_Investigative_Committee_of_Russia.svg.png" width="80" style="margin-bottom:20px; opacity:0.8">
        <h3>–ê–ò–° ¬´–ë–ê–°–¢–ò–û–ù-–ì–°–£¬ª</h3>
        <p style="color:var(--text-mute); font-size:0.8rem; margin-bottom:20px;">–í—Å—Ç–∞–≤—å—Ç–µ —Å–º–∞—Ä—Ç-–∫–∞—Ä—Ç—É –∏–ª–∏ –≤–≤–µ–¥–∏—Ç–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</p>
        <input id="l-user" class="input-f" placeholder="–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞">
        <input id="l-pass" type="password" class="input-f" placeholder="–ü–∞—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞">
        <button class="btn btn-blue" onclick="auth()">–í–û–ô–¢–ò –í –°–ò–°–¢–ï–ú–£</button>
        <p style="color:#ef4444; font-size:0.7rem; margin-top:20px;">–í–ù–ò–ú–ê–ù–ò–ï: –í–µ–¥–µ—Ç—Å—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π (–°—Ç. 272 –£–ö –†–§)</p>
    </div>
</div>

<!-- APP -->
<div id="app">
    <header>
        <div class="brand">
            <span style="font-size:1.5rem">üõ°</span> –ì–õ–ê–í–ù–û–ï –°–õ–ï–î–°–¢–í–ï–ù–ù–û–ï –£–ü–†–ê–í–õ–ï–ù–ò–ï <span class="badge badge-dsp">–î–°–ü</span>
        </div>
        <div style="text-align:right">
            <div id="u-name" style="font-weight:bold; font-size:0.9rem;"></div>
            <div id="u-rank" style="font-size:0.75rem; color:var(--text-mute);"></div>
        </div>
    </header>

    <aside>
        <div class="nav-cat">–û–ü–ï–†–ê–¢–ò–í–ù–û–ï –£–ü–†–ê–í–õ–ï–ù–ò–ï</div>
        <div class="nav-item active" onclick="go('dash')">üìä –ì–õ–ê–í–ù–ê–Ø (–°–≤–æ–¥–∫–∞)</div>
        <div class="nav-item" onclick="go('kusp')">üì• –ö–ê–ù–¶–ï–õ–Ø–†–ò–Ø (–ö–£–°–ü)</div>
        <div class="nav-item" onclick="go('cases')">üìÅ –°–õ–ï–î–°–¢–í–ò–ï (–î–µ–ª–∞)</div>
        <div class="nav-item" onclick="go('wanted')">üïµÔ∏è –†–û–ó–´–°–ö (–ë–∞–∑–∞)</div>
        <div class="nav-item" onclick="go('chat')">üí¨ –°–ü–ï–¶–°–í–Ø–ó–¨</div>

        <div class="nav-cat">–ê–î–ú–ò–ù–ò–°–¢–†–ò–†–û–í–ê–ù–ò–ï</div>
        <div class="nav-item" id="adm-btn" onclick="go('hr')" style="color:#fbbf24; display:none;">üëë –£–ü–†–ê–í–õ–ï–ù–ò–ï –ö–ê–î–†–û–í</div>
        <div class="nav-item" onclick="go('armory')">üî´ –ê–†–°–ï–ù–ê–õ (–ö–•–û)</div>
        <div class="nav-item" onclick="go('garage')">üöî –ê–í–¢–û–•–û–ó–Ø–ô–°–¢–í–û</div>
        
        <div class="nav-cat">–í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï</div>
        <div class="nav-item" onclick="go('experts')">üî¨ –≠–ö–¶ (–≠–∫—Å–ø–µ—Ä—Ç–∏–∑—ã)</div>
        <div class="nav-item" onclick="go('sizo')">‚öñÔ∏è –°–ò–ó–û / –ò–í–°</div>
        <div class="nav-item" onclick="go('archive')">üóÑ –ê–†–•–ò–í –î–ï–õ</div>
        <div class="nav-item" onclick="go('laws')">üìñ –°–ü–†–ê–í–û–ß–ù–ò–ö (–ù–ü–ê)</div>

        <div style="margin-top:auto; padding:20px;">
            <button class="btn btn-red" onclick="location.reload()">–ó–ê–í–ï–†–®–ò–¢–¨ –°–ï–ê–ù–°</button>
        </div>
    </aside>

    <main id="view"></main>
</div>

<!-- MODAL: EDIT USER -->
<div id="m-user" class="modal-wrap">
    <div class="modal">
        <h3 style="color:white; border-bottom:1px solid #333; padding-bottom:10px;">–õ–ò–ß–ù–û–ï –î–ï–õ–û –°–û–¢–†–£–î–ù–ò–ö–ê</h3>
        <input type="hidden" id="e-id">
        <label>–§–ò–û</label><input id="e-fio" class="input-f">
        <label>–°–ø–µ—Ü–∏–∞–ª—å–Ω–æ–µ –∑–≤–∞–Ω–∏–µ</label>
        <select id="e-rank" class="input-f">
            <option>–ì–µ–Ω–µ—Ä–∞–ª —é—Å—Ç–∏—Ü–∏–∏ –†–§</option><option>–ì–µ–Ω–µ—Ä–∞–ª-–ø–æ–ª–∫–æ–≤–Ω–∏–∫</option><option>–ì–µ–Ω–µ—Ä–∞–ª-–ª–µ–π—Ç–µ–Ω–∞–Ω—Ç</option><option>–ì–µ–Ω–µ—Ä–∞–ª-–º–∞–π–æ—Ä</option>
            <option>–ü–æ–ª–∫–æ–≤–Ω–∏–∫ —é—Å—Ç–∏—Ü–∏–∏</option><option>–ü–æ–¥–ø–æ–ª–∫–æ–≤–Ω–∏–∫ —é—Å—Ç–∏—Ü–∏–∏</option><option>–ú–∞–π–æ—Ä —é—Å—Ç–∏—Ü–∏–∏</option><option>–ö–∞–ø–∏—Ç–∞–Ω —é—Å—Ç–∏—Ü–∏–∏</option><option>–õ–µ–π—Ç–µ–Ω–∞–Ω—Ç —é—Å—Ç–∏—Ü–∏–∏</option>
        </select>
        <label>–î–æ–ª–∂–Ω–æ—Å—Ç—å</label><input id="e-pos" class="input-f">
        <label>–ù–∞–≥—Ä–∞–¥—ã (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)</label><textarea id="e-medals" class="input-f" rows="3"></textarea>
        <label>–£—Ä–æ–≤–µ–Ω—å –¥–æ—Å—Ç—É–ø–∞ (1-–°–ª–µ–¥, 2-–ù–∞—á, 3-–ì–µ–Ω–µ—Ä–∞–ª)</label><input id="e-role" type="number" class="input-f">
        
        <div style="display:flex; gap:10px; margin-top:20px;">
            <button class="btn btn-blue" onclick="saveUser()">–°–û–•–†–ê–ù–ò–¢–¨ –ò–ó–ú–ï–ù–ï–ù–ò–Ø</button>
            <button class="btn btn-outline" onclick="document.getElementById('m-user').style.display='none'">–û–¢–ú–ï–ù–ê</button>
        </div>
    </div>
</div>

<script>
    // --- DATABASE ---
    const DB_KEY = 'ais_bastion_v9';
    const INIT_DB = {
        users: [
            { id: 1, fio: "–ö—Ä–∞—Å–∏–Ω –ê–ª–µ–∫—Å–∞–Ω–¥—Ä –í–ª–∞–¥–∏–º–∏—Ä–æ–≤–∏—á", rank: "–ì–µ–Ω–µ—Ä–∞–ª —é—Å—Ç–∏—Ü–∏–∏ –†–§", pos: "–†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å –ì–°–£", role: 3, pass: "–ö—Ä–∞—Å–∏–Ω222", medals: "–ì–µ—Ä–æ–π –†–§, –ó–∞ –∑–∞—Å–ª—É–≥–∏ –ø–µ—Ä–µ–¥ –û—Ç–µ—á–µ—Å—Ç–≤–æ–º" },
            { id: 2, fio: "–ü–µ—Ç—Ä–æ–≤ –ò–≤–∞–Ω –°–µ—Ä–≥–µ–µ–≤–∏—á", rank: "–õ–µ–π—Ç–µ–Ω–∞–Ω—Ç —é—Å—Ç–∏—Ü–∏–∏", pos: "–°–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å", role: 1, pass: "123", medals: "" }
        ],
        cases: [ { num: "159-24", art: "105 –£–ö –†–§", desc: "–£–±–∏–π—Å—Ç–≤–æ –Ω–∞ —É–ª. –õ–µ–Ω–∏–Ω–∞", invest: "–ö—Ä–∞—Å–∏–Ω –ê.–í.", status: "–í –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ" } ],
        kusp: [ { id: 1001, text: "–°–æ–æ–±—â–µ–Ω–∏–µ –æ –∫—Ä–∞–∂–µ –∏–º—É—â–µ—Å—Ç–≤–∞", date: "16.02.2026", status: "–ü—Ä–∏–Ω—è—Ç–æ" } ],
        wanted: [ { name: "–°–∏–¥–æ—Ä–æ–≤ –ê.–ê.", reason: "–°—Ç. 159 —á.4", status: "–§–µ–¥–µ—Ä–∞–ª—å–Ω—ã–π —Ä–æ–∑—ã—Å–∫" } ],
        chat: [ { user: "–î–µ–∂—É—Ä–Ω—ã–π", text: "–°–≤–æ–¥–∫–∞ –∑–∞ —Å—É—Ç–∫–∏ –∑–∞–≥—Ä—É–∂–µ–Ω–∞.", time: "08:00" } ]
    };

    let DB = JSON.parse(localStorage.getItem(DB_KEY)) || INIT_DB;
    let Me = null;

    function save() { localStorage.setItem(DB_KEY, JSON.stringify(DB)); }
    
    // --- AUTH ---
    function auth() {
        const u = document.getElementById('l-user').value.trim();
        const p = document.getElementById('l-pass').value.trim();
        const user = DB.users.find(x => x.fio === u && x.pass === p);
        if(user) {
            Me = user;
            document.getElementById('login-screen').style.display = 'none';
            document.getElementById('app').style.display = 'grid';
            document.getElementById('u-name').innerText = Me.fio;
            document.getElementById('u-rank').innerText = Me.rank;
            if(Me.role >= 3) document.getElementById('adm-btn').style.display = 'flex';
            go('dash');
        } else alert("–û–®–ò–ë–ö–ê –ê–í–¢–û–†–ò–ó–ê–¶–ò–ò: –ù–µ–≤–µ—Ä–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–ª–∏ —Ç–æ–∫–µ–Ω.");
    }

    // --- NAVIGATION ---
    function go(page) {
        document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
        if(event && event.currentTarget) event.currentTarget.classList.add('active');
        const v = document.getElementById('view');
        
        if(page === 'dash') {
            v.innerHTML = `
            <div class="card">
                <h2>–û–ü–ï–†–ê–¢–ò–í–ù–ê–Ø –°–í–û–î–ö–ê <span style="font-size:0.8rem; color:#6b7280">${new Date().toLocaleDateString()}</span></h2>
                <div style="display:grid; grid-template-columns:repeat(4,1fr); gap:20px;">
                    <div style="background:#111827; padding:15px; border-left:4px solid var(--primary);">
                        <div style="color:#9ca3af; font-size:0.8rem">–í –ü–†–û–ò–ó–í–û–î–°–¢–í–ï</div>
                        <div style="font-size:1.5rem; font-weight:bold">${DB.cases.length}</div>
                    </div>
                    <div style="background:#111827; padding:15px; border-left:4px solid var(--accent);">
                        <div style="color:#9ca3af; font-size:0.8rem">–ö–†–ò–ú–ò–ù–ê–õ (–ö–£–°–ü)</div>
                        <div style="font-size:1.5rem; font-weight:bold">${DB.kusp.length}</div>
                    </div>
                    <div style="background:#111827; padding:15px; border-left:4px solid #059669;">
                        <div style="color:#9ca3af; font-size:0.8rem">–õ–ò–ß–ù–´–ô –°–û–°–¢–ê–í</div>
                        <div style="font-size:1.5rem; font-weight:bold">${DB.users.length}</div>
                    </div>
                    <div style="background:#111827; padding:15px; border-left:4px solid #fbbf24;">
                        <div style="color:#9ca3af; font-size:0.8rem">–í –†–û–ó–´–°–ö–ï</div>
                        <div style="font-size:1.5rem; font-weight:bold">${DB.wanted.length}</div>
                    </div>
                </div>
            </div>`;
        }
        else if(page === 'hr') {
            if(Me.role < 3) return v.innerHTML = '<div class="card"><h2>–î–û–°–¢–£–ü –ó–ê–ü–†–ï–©–ï–ù</h2></div>';
            let h = `<div class="card">
                <h2>–£–ü–†–ê–í–õ–ï–ù–ò–ï –ö–ê–î–†–ê–ú–ò <button class="btn btn-blue" style="width:auto; padding:5px 15px;" onclick="newUser()">+ –ù–ê–ó–ù–ê–ß–ò–¢–¨</button></h2>
                <table><thead><tr><th>–ó–í–ê–ù–ò–ï</th><th>–°–û–¢–†–£–î–ù–ò–ö</th><th>–î–û–õ–ñ–ù–û–°–¢–¨</th><th>–ù–ê–ì–†–ê–î–´</th><th>–î–ï–ô–°–¢–í–ò–Ø</th></tr></thead><tbody>`;
            DB.users.forEach(u => {
                h += `<tr>
                    <td style="color:#fbbf24">${u.rank}</td>
                    <td><b>${u.fio}</b></td>
                    <td>${u.pos}</td>
                    <td style="font-size:0.7rem">${u.medals || '-'}</td>
                    <td>
                        <button class="btn btn-outline" style="padding:4px 8px;" onclick="editUser(${u.id})">–ò–ó–ú.</button>
                        ${u.id !== Me.id ? `<button class="btn btn-red" style="padding:4px 8px;" onclick="delUser(${u.id})">–£–í–û–õ.</button>` : ''}
                    </td>
                </tr>`;
            });
            v.innerHTML = h + `</tbody></table></div>`;
        }
        else if(page === 'cases') {
            v.innerHTML = `<div class="card"><h2>–£–ì–û–õ–û–í–ù–´–ï –î–ï–õ–ê <button class="btn btn-blue" style="width:auto; padding:5px 15px" onclick="addCase()">+ –í–û–ó–ë–£–î–ò–¢–¨</button></h2>
            <table><thead><tr><th>‚Ññ –î–ï–õ–ê</th><th>–°–¢–ê–¢–¨–Ø</th><th>–§–ê–ë–£–õ–ê</th><th>–°–õ–ï–î–û–í–ê–¢–ï–õ–¨</th><th>–°–¢–ê–¢–£–°</th></tr></thead>
            <tbody>${DB.cases.map(c => `<tr><td>${c.num}</td><td>${c.art}</td><td>${c.desc}</td><td>${c.invest}</td><td><span class="badge badge-dsp">${c.status}</span></td></tr>`).join('')}</tbody></table></div>`;
        }
        else if(page === 'chat') {
             v.innerHTML = `<div class="card"><h2>–°–ü–ï–¶–°–í–Ø–ó–¨ (–ó–ê–ö–†–´–¢–´–ô –ö–ê–ù–ê–õ)</h2>
             <div style="height:300px; overflow-y:auto; background:#111827; padding:10px; border:1px solid #374151; margin-bottom:10px;">
                ${DB.chat.map(m => `<div style="margin-bottom:5px;"><span style="color:#2563eb">[${m.time}] ${m.user}:</span> ${m.text}</div>`).join('')}
             </div>
             <div style="display:flex; gap:10px;"><input id="chat-msg" class="input-f" style="margin:0"><button class="btn btn-blue" style="width:100px" onclick="sendMsg()">–û–¢–ü–†.</button></div>
             </div>`;
        }
        else if(page === 'wanted') {
             v.innerHTML = `<div class="card"><h2>–§–ï–î–ï–†–ê–õ–¨–ù–´–ô –†–û–ó–´–°–ö <button class="btn btn-red" style="width:auto; padding:5px 15px" onclick="addWanted()">+ –û–ë–™–Ø–í–ò–¢–¨</button></h2>
             <table><thead><tr><th>–§–ò–û</th><th>–ü–†–ò–ß–ò–ù–ê –†–û–ó–´–°–ö–ê</th><th>–°–¢–ê–¢–£–°</th></tr></thead>
             <tbody>${DB.wanted.map(w => `<tr><td><b>${w.name}</b></td><td>${w.reason}</td><td><span class="badge badge-dsp">${w.status}</span></td></tr>`).join('')}</tbody></table></div>`;
        }
        else {
            // Placeholder for other 8 sections
            const titles = { 'kusp': '–ö–ê–ù–¶–ï–õ–Ø–†–ò–Ø (–ö–£–°–ü)', 'armory': '–ö–û–ú–ù–ê–¢–ê –•–†–ê–ù–ï–ù–ò–Ø –û–†–£–ñ–ò–Ø', 'garage': '–ê–í–¢–û–•–û–ó–Ø–ô–°–¢–í–û', 'experts': '–≠–ö–°–ü–ï–†–¢–ù–û-–ö–†–ò–ú–ò–ù–ê–õ–ò–°–¢–ò–ß–ï–°–ö–ò–ô –¶–ï–ù–¢–†', 'sizo': '–ò–ó–û–õ–Ø–¢–û–† –í–†–ï–ú–ï–ù–ù–û–ì–û –°–û–î–ï–†–ñ–ê–ù–ò–Ø', 'archive': '–ê–†–•–ò–í –£–ì–û–õ–û–í–ù–´–• –î–ï–õ', 'laws': '–ù–û–†–ú–ê–¢–ò–í–ù–û-–ü–†–ê–í–û–í–ê–Ø –ë–ê–ó–ê' };
            v.innerHTML = `<div class="card"><h2>${titles[page] || '–†–ê–ó–î–ï–õ'}</h2><p style="color:#9ca3af">–î–æ—Å—Ç—É–ø –∫ —Ä–∞–∑–¥–µ–ª—É –∞–∫—Ç–∏–≤–µ–Ω. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–∞.</p><br><div style="padding:20px; border:1px dashed #374151; text-align:center; color:#4b5563">–ù–ï–¢ –ê–ö–¢–ò–í–ù–´–• –ó–ê–ü–ò–°–ï–ô –ó–ê –¢–ï–ö–£–©–ò–ï –°–£–¢–ö–ò</div></div>`;
        }
    }

    // --- LOGIC ---
    function newUser() {
        const fio = prompt("–§–ò–û —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞:");
        const pass = prompt("–ü–∞—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞:");
        if(fio && pass) { DB.users.push({id:Date.now(), fio, pass, rank:"–õ–µ–π—Ç–µ–Ω–∞–Ω—Ç —é—Å—Ç–∏—Ü–∏–∏", pos:"–°–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å", role:1}); save(); go('hr'); }
    }
    
    function editUser(id) {
        const u = DB.users.find(x => x.id === id);
        if(!u) return;
        document.getElementById('e-id').value = u.id;
        document.getElementById('e-fio').value = u.fio;
        document.getElementById('e-rank').value = u.rank;
        document.getElementById('e-pos').value = u.pos;
        document.getElementById('e-medals').value = u.medals || '';
        document.getElementById('e-role').value = u.role;
        document.getElementById('m-user').style.display = 'flex';
    }

    function saveUser() {
        const id = parseInt(document.getElementById('e-id').value);
        const u = DB.users.find(x => x.id === id);
        if(u) {
            u.fio = document.getElementById('e-fio').value;
            u.rank = document.getElementById('e-rank').value;
            u.pos = document.getElementById('e-pos').value;
            u.medals = document.getElementById('e-medals').value;
            u.role = parseInt(document.getElementById('e-role').value);
            save(); document.getElementById('m-user').style.display = 'none'; go('hr');
        }
    }

    function delUser(id) { if(confirm("–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –ø—Ä–∏–∫–∞–∑ –æ–± —É–≤–æ–ª—å–Ω–µ–Ω–∏–∏.")) { DB.users = DB.users.filter(x => x.id !== id); save(); go('hr'); } }
    
    function addCase() {
        const art = prompt("–°—Ç–∞—Ç—å—è –£–ö –†–§:");
        if(art) { DB.cases.push({num: Math.floor(Math.random()*1000)+"-26", art, desc:"–í–æ–∑–±—É–∂–¥–µ–Ω–æ –ø–æ —Ä–∞–ø–æ—Ä—Ç—É", invest: Me.fio, status:"–í –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ"}); save(); go('cases'); }
    }
    
    function addWanted() {
        const n = prompt("–§–ò–û –ø–æ–¥–æ–∑—Ä–µ–≤–∞–µ–º–æ–≥–æ:");
        if(n) { DB.wanted.push({name:n, reason:"–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è", status:"–í —Ä–æ–∑—ã—Å–∫–µ"}); save(); go('wanted'); }
    }
    
    function sendMsg() {
        const t = document.getElementById('chat-msg').value;
        if(t) { DB.chat.push({user:Me.fio, text:t, time: new Date().toLocaleTimeString()}); save(); document.getElementById('chat-msg').value=''; go('chat'); }
    }

</script>
</body>
</html>
