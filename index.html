<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ê–ò–° ¬´–ë–ê–°–¢–ò–û–ù¬ª | –ì–°–£ –°–ö –†–§</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #1e3a8a; /* –ì–ª—É–±–æ–∫–∏–π —Å–∏–Ω–∏–π –°–ö */
            --secondary: #1e293b;
            --accent: #dc2626; /* –ö—Ä–∞—Å–Ω—ã–π */
            --bg: #f1f5f9;
            --text: #0f172a;
            --gold: #d97706;
        }

        * { box-sizing: border-box; }
        body { margin: 0; font-family: 'Roboto', sans-serif; background: var(--bg); color: var(--text); height: 100vh; overflow: hidden; }

        /* --- LOGIN --- */
        #auth-layer { position: fixed; inset: 0; background: #0f172a; z-index: 9999; display: flex; align-items: center; justify-content: center; }
        .auth-box { background: #fff; width: 400px; padding: 40px; border-radius: 4px; text-align: center; border-top: 4px solid var(--accent); box-shadow: 0 25px 50px -12px rgba(0,0,0,0.25); }
        .auth-inp { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #cbd5e1; border-radius: 4px; font-size: 14px; }
        .btn { border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer; font-weight: 500; text-transform: uppercase; font-size: 0.8rem; transition: 0.2s; }
        .btn-blue { background: var(--primary); color: white; }
        .btn-blue:hover { background: #1e40af; }
        .btn-red { background: var(--accent); color: white; }
        .btn-outline { background: transparent; border: 1px solid #ccc; }

        /* --- LAYOUT --- */
        #main-ui { display: none; grid-template-columns: 240px 1fr; grid-template-rows: 60px 1fr; height: 100vh; }
        
        /* Header */
        header { grid-column: 1 / 3; background: #fff; border-bottom: 1px solid #e2e8f0; display: flex; align-items: center; justify-content: space-between; padding: 0 20px; z-index: 10; }
        .brand { font-weight: 700; color: var(--primary); display: flex; align-items: center; gap: 10px; font-size: 1.1rem; }
        .user-panel { font-size: 0.8rem; text-align: right; line-height: 1.2; }

        /* Sidebar */
        aside { background: var(--secondary); color: #94a3b8; display: flex; flex-direction: column; padding-top: 20px; }
        .nav-item { padding: 12px 20px; cursor: pointer; transition: 0.2s; border-left: 3px solid transparent; font-size: 0.9rem; }
        .nav-item:hover { background: #334155; color: white; }
        .nav-item.active { background: #334155; color: white; border-left-color: var(--accent); }
        .nav-cat { font-size: 0.7rem; text-transform: uppercase; padding: 20px 20px 5px; color: #64748b; font-weight: bold; }

        /* Content */
        main { padding: 30px; overflow-y: auto; position: relative; }
        .panel { background: #fff; border: 1px solid #e2e8f0; border-radius: 6px; padding: 20px; margin-bottom: 20px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
        
        /* Elements */
        .table-w { width: 100%; border-collapse: collapse; font-size: 0.85rem; }
        .table-w th { text-align: left; padding: 10px; background: #f8fafc; color: #64748b; border-bottom: 2px solid #e2e8f0; }
        .table-w td { padding: 10px; border-bottom: 1px solid #f1f5f9; }
        .status-badge { padding: 2px 8px; border-radius: 10px; font-size: 0.7rem; font-weight: bold; }
        .st-green { background: #dcfce7; color: #166534; }
        .st-red { background: #fee2e2; color: #991b1b; }
        .st-blue { background: #dbeafe; color: #1e40af; }

        /* MODALS */
        .modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.6); display: none; align-items: center; justify-content: center; z-index: 100; }
        .modal { background: #fff; width: 600px; max-height: 90vh; overflow-y: auto; padding: 30px; border-radius: 6px; }
        .form-row { margin-bottom: 15px; }
        .form-label { display: block; font-size: 0.8rem; color: #64748b; margin-bottom: 5px; }
        .form-control { width: 100%; padding: 10px; border: 1px solid #cbd5e1; border-radius: 4px; }

    </style>
</head>
<body>

    <!-- –í–•–û–î -->
    <div id="auth-layer">
        <div class="auth-box">
            <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/c/ca/Emblem_of_the_Investigative_Committee_of_Russia.svg/1200px-Emblem_of_the_Investigative_Committee_of_Russia.svg.png" style="width:80px; margin-bottom:20px;">
            <h3>–ê–ò–° ¬´–ë–ê–°–¢–ò–û–ù¬ª</h3>
            <p style="font-size:0.8rem; color:#64748b; margin-bottom:20px;">–ï–î–ò–ù–ê–Ø –°–ò–°–¢–ï–ú–ê –°–ö –†–û–°–°–ò–ò</p>
            <input id="l-login" class="auth-inp" placeholder="–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä (–§–ò–û)">
            <input id="l-pass" type="password" class="auth-inp" placeholder="–ü–∞—Ä–æ–ª—å">
            <button class="btn btn-blue" style="width:100%" onclick="login()">–í–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É</button>
            <button class="btn btn-outline" style="width:100%; margin-top:10px; font-size:0.7rem; border:none; color:#666;" onclick="resetSystem()">–°–ë–†–û–° –°–ò–°–¢–ï–ú–´ (–ï–°–õ–ò –û–®–ò–ë–ö–ê)</button>
        </div>
    </div>

    <!-- –ò–ù–¢–ï–†–§–ï–ô–° -->
    <div id="main-ui">
        <header>
            <div class="brand">
                <span style="color:var(--accent)">‚òÖ</span> –ì–õ–ê–í–ù–û–ï –°–õ–ï–î–°–¢–í–ï–ù–ù–û–ï –£–ü–†–ê–í–õ–ï–ù–ò–ï
            </div>
            <div class="user-panel">
                <div id="h-name" style="font-weight:bold;">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
                <div id="h-rank" style="color:#64748b;">...</div>
            </div>
        </header>
        
        <aside>
            <div class="nav-item active" onclick="go('dash')">üìä –°–≤–æ–¥–∫–∞</div>
            
            <div class="nav-cat">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (–ö–∞–¥—Ä—ã)</div>
            <div class="nav-item" onclick="go('staff')">üë• –õ–∏—á–Ω—ã–π —Å–æ—Å—Ç–∞–≤</div>
            <div class="nav-item" onclick="go('awards')">üéñ –ù–∞–≥—Ä–∞–¥–Ω–æ–π –æ—Ç–¥–µ–ª</div>
            
            <div class="nav-cat">–°–ª–µ–¥—Å—Ç–≤–∏–µ</div>
            <div class="nav-item" onclick="go('kusp')">üìï –ö–£–°–ü</div>
            <div class="nav-item" onclick="go('cases')">üìÅ –£–≥–æ–ª–æ–≤–Ω—ã–µ –¥–µ–ª–∞</div>
            
            <div class="nav-cat">–û–±–µ—Å–ø–µ—á–µ–Ω–∏–µ</div>
            <div class="nav-item" onclick="go('armory')">üî´ –û—Ä—É–∂–µ–π–Ω–∞—è</div>
            <div class="nav-item" onclick="go('garage')">üöî –ê–≤—Ç–æ–ø–∞—Ä–∫</div>
            
            <div style="margin-top:auto; padding:20px;">
                <button class="btn btn-red" style="width:100%" onclick="logout()">–í–´–•–û–î</button>
            </div>
        </aside>

        <main id="view"></main>
    </div>

    <!-- –ú–û–î–ê–õ–ö–ê –†–ï–î–ê–ö–¢–ò–†–û–í–ê–ù–ò–Ø –°–û–¢–†–£–î–ù–ò–ö–ê -->
    <div id="m-edit" class="modal-overlay">
        <div class="modal">
            <h3>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞</h3>
            <input type="hidden" id="e-id">
            <div class="form-row">
                <label class="form-label">–§–ò–û</label>
                <input id="e-fio" class="form-control" disabled style="background:#f1f5f9;">
            </div>
            <div class="form-row">
                <label class="form-label">–ó–≤–∞–Ω–∏–µ</label>
                <select id="e-rank" class="form-control">
                    <option>–ì–µ–Ω–µ—Ä–∞–ª —é—Å—Ç–∏—Ü–∏–∏</option><option>–ì–µ–Ω–µ—Ä–∞–ª-–ø–æ–ª–∫–æ–≤–Ω–∏–∫</option><option>–ì–µ–Ω–µ—Ä–∞–ª-–ª–µ–π—Ç–µ–Ω–∞–Ω—Ç</option><option>–ü–æ–ª–∫–æ–≤–Ω–∏–∫ —é—Å—Ç–∏—Ü–∏–∏</option>
                    <option>–ü–æ–¥–ø–æ–ª–∫–æ–≤–Ω–∏–∫ —é—Å—Ç–∏—Ü–∏–∏</option><option>–ú–∞–π–æ—Ä —é—Å—Ç–∏—Ü–∏–∏</option><option>–ö–∞–ø–∏—Ç–∞–Ω —é—Å—Ç–∏—Ü–∏–∏</option><option>–°—Ç. –ª–µ–π—Ç–µ–Ω–∞–Ω—Ç —é—Å—Ç–∏—Ü–∏–∏</option><option>–õ–µ–π—Ç–µ–Ω–∞–Ω—Ç —é—Å—Ç–∏—Ü–∏–∏</option>
                </select>
            </div>
            <div class="form-row">
                <label class="form-label">–î–æ–ª–∂–Ω–æ—Å—Ç—å</label>
                <input id="e-pos" class="form-control">
            </div>
            <div class="form-row">
                <label class="form-label">–û—Ç–¥–µ–ª</label>
                <select id="e-dept" class="form-control">
                    <option>–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –£–ø—Ä–∞–≤–ª–µ–Ω–∏—è</option>
                    <option>–û—Ç–¥–µ–ª –ø–æ —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—é –û–í–î</option>
                    <option>–ö—Ä–∏–º–∏–Ω–∞–ª–∏—Å—Ç–∏—á–µ—Å–∫–∏–π —Ü–µ–Ω—Ç—Ä</option>
                    <option>–û—Ç–¥–µ–ª —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏</option>
                </select>
            </div>
            <div class="form-row">
                <label class="form-label">–ù–∞–≥—Ä–∞–¥—ã (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)</label>
                <textarea id="e-medals" class="form-control" rows="3"></textarea>
            </div>
            <div style="text-align:right">
                <button class="btn btn-outline" onclick="closeM()">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn btn-blue" onclick="saveUser()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è</button>
            </div>
        </div>
    </div>

    <script>
        // --- –ë–ê–ó–ê –î–ê–ù–ù–´–• ---
        const DB_KEY = 'ais_bastion_v8';
        const INIT_DB = {
            users: [
                { id: 1, fio: "–ö—Ä–∞—Å–∏–Ω –ê–ª–µ–∫—Å–∞–Ω–¥—Ä –í–ª–∞–¥–∏–º–∏—Ä–æ–≤–∏—á", rank: "–ì–µ–Ω–µ—Ä–∞–ª —é—Å—Ç–∏—Ü–∏–∏", pos: "–†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å –£–ø—Ä–∞–≤–ª–µ–Ω–∏—è", dept: "–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –£–ø—Ä–∞–≤–ª–µ–Ω–∏—è", medals: "–ó–∞ –≤–µ—Ä–Ω–æ—Å—Ç—å –¥–æ–ª–≥—É, –í–µ—Ç–µ—Ä–∞–Ω —Å–ª–µ–¥—Å—Ç–≤–∏—è", role: 3, pass: "–ö—Ä–∞—Å–∏–Ω222" }
            ],
            cases: [
                { num: "144002", article: "290 –£–ö –†–§", suspect: "–°–º–∏—Ä–Ω–æ–≤ –ê.–ê.", investigator: "–ö—Ä–∞—Å–∏–Ω –ê.–í.", status: "–í –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ" }
            ],
            kusp: [],
            armory: [],
            garage: [
                { num: "–ê001–ú–† 97", car: "Aurus Senat", status: "–°–≤–æ–±–æ–¥–µ–Ω" },
                { num: "–ê002–ú–† 97", car: "Toyota Land Cruiser 300", status: "–°–≤–æ–±–æ–¥–µ–Ω" },
                { num: "–°112–ö–ö 77", car: "Ford Focus III", status: "–°–≤–æ–±–æ–¥–µ–Ω" }
            ]
        };

        let DB = JSON.parse(localStorage.getItem(DB_KEY)) || INIT_DB;
        let Me = null;

        // --- CORE FUNCTIONS ---
        function sync() { localStorage.setItem(DB_KEY, JSON.stringify(DB)); }
        
        function resetSystem() {
            if(confirm("–ü–û–õ–ù–´–ô –°–ë–†–û–° –í–°–ï–• –î–ê–ù–ù–´–•?")) {
                localStorage.removeItem(DB_KEY);
                location.reload();
            }
        }

        function login() {
            const f = document.getElementById('l-login').value.trim();
            const p = document.getElementById('l-pass').value.trim();
            const u = DB.users.find(x => x.fio === f && x.pass === p);
            if(u) {
                Me = u;
                document.getElementById('auth-layer').style.display = 'none';
                document.getElementById('main-ui').style.display = 'grid';
                document.getElementById('h-name').innerText = Me.fio;
                document.getElementById('h-rank').innerText = Me.rank;
                go('dash');
            } else alert("–û—à–∏–±–∫–∞ –¥–æ—Å—Ç—É–ø–∞. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–∞–Ω–Ω—ã–µ.");
        }

        function logout() { location.reload(); }

        // --- NAVIGATION & RENDERING ---
        function go(page) {
            document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
            event && event.currentTarget && event.currentTarget.classList.add('active');
            const v = document.getElementById('view');

            if(page === 'dash') {
                v.innerHTML = `
                <div class="panel">
                    <h2>–û–ø–µ—Ä–∞—Ç–∏–≤–Ω–∞—è –æ–±—Å—Ç–∞–Ω–æ–≤–∫–∞</h2>
                    <div style="display:grid; grid-template-columns: repeat(3, 1fr); gap:20px;">
                        <div style="background:#eff6ff; padding:20px; border-radius:8px; border-left:5px solid var(--primary);">
                            <div style="font-size:2rem; font-weight:bold; color:var(--primary)">${DB.users.length}</div>
                            <div style="font-size:0.8rem; color:#64748b">–õ–∏—á–Ω—ã–π —Å–æ—Å—Ç–∞–≤</div>
                        </div>
                        <div style="background:#fef2f2; padding:20px; border-radius:8px; border-left:5px solid var(--accent);">
                            <div style="font-size:2rem; font-weight:bold; color:var(--accent)">${DB.cases.length}</div>
                            <div style="font-size:0.8rem; color:#64748b">–£–≥–æ–ª–æ–≤–Ω—ã—Ö –¥–µ–ª</div>
                        </div>
                        <div style="background:#fff7ed; padding:20px; border-radius:8px; border-left:5px solid var(--gold);">
                            <div style="font-size:2rem; font-weight:bold; color:var(--gold)">${DB.garage.filter(c=>c.status==='–°–≤–æ–±–æ–¥–µ–Ω').length}</div>
                            <div style="font-size:0.8rem; color:#64748b">–ú–∞—à–∏–Ω –≤ —Ä–µ–∑–µ—Ä–≤–µ</div>
                        </div>
                    </div>
                </div>`;
            }
            else if(page === 'staff') {
                let h = `<div class="panel"><div style="display:flex; justify-content:space-between"><h2>–õ–∏—á–Ω—ã–π —Å–æ—Å—Ç–∞–≤</h2>`;
                if(Me.role >= 2) h += `<button class="btn btn-blue" onclick="regUser()">+ –ù–æ–≤—ã–π —Å–æ—Ç—Ä—É–¥–Ω–∏–∫</button>`;
                h += `</div><table class="table-w"><thead><tr><th>–°–æ—Ç—Ä—É–¥–Ω–∏–∫</th><th>–î–æ–ª–∂–Ω–æ—Å—Ç—å/–û—Ç–¥–µ–ª</th><th>–ù–∞–≥—Ä–∞–¥—ã</th><th>–î–µ–π—Å—Ç–≤–∏—è</th></tr></thead><tbody>`;
                
                DB.users.forEach(u => {
                    h += `<tr>
                        <td><b>${u.rank}</b><br>${u.fio}</td>
                        <td>${u.pos}<br><small style="color:#64748b">${u.dept}</small></td>
                        <td style="font-size:0.7rem; color:#d97706;">${u.medals || '-'}</td>
                        <td>`;
                    if(Me.role >= 2 || Me.id === u.id) {
                        h += `<button class="btn btn-outline" style="padding:5px" onclick="editUser(${u.id})">‚úèÔ∏è –ò–∑–º.</button>`;
                    }
                    if(Me.role === 3 && Me.id !== u.id) {
                         h += `<button class="btn btn-red" style="padding:5px; margin-left:5px;" onclick="delUser(${u.id})">–£–≤–æ–ª.</button>`;
                    }
                    h += `</td></tr>`;
                });
                v.innerHTML = h + `</tbody></table></div>`;
            }
            else if(page === 'cases') {
                v.innerHTML = `<div class="panel"><h2>–†–µ–µ—Å—Ç—Ä —É–≥–æ–ª–æ–≤–Ω—ã—Ö –¥–µ–ª</h2>
                <button class="btn btn-blue" style="margin-bottom:15px" onclick="addCase()">+ –í–æ–∑–±—É–¥–∏—Ç—å –¥–µ–ª–æ</button>
                <table class="table-w"><thead><tr><th>–ù–æ–º–µ—Ä</th><th>–°—Ç–∞—Ç—å—è –£–ö –†–§</th><th>–ü–æ–¥–æ–∑—Ä–µ–≤–∞–µ–º—ã–π</th><th>–°–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å</th><th>–°—Ç–∞—Ç—É—Å</th></tr></thead>
                <tbody>${DB.cases.map(c => `
                    <tr><td><b>${c.num}</b></td><td>${c.article}</td><td>${c.suspect}</td><td>${c.investigator}</td>
                    <td><span class="status-badge st-red">${c.status}</span></td></tr>
                `).join('')}</tbody></table></div>`;
            }
            else if(page === 'kusp') {
                v.innerHTML = `<div class="panel"><h2>–ö–£–°–ü (–ö–Ω–∏–≥–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏–π)</h2><p>–î–∞–Ω–Ω—ã–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É—é—Ç—Å—è —Å –¥–µ–∂—É—Ä–Ω–æ–π —á–∞—Å—Ç—å—é.</p></div>`;
            }
            else if(page === 'armory') {
                v.innerHTML = `<div class="panel"><h2>–ö–æ–º–Ω–∞—Ç–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è –æ—Ä—É–∂–∏—è (–ö–•–û)</h2>
                <div style="display:flex; gap:10px; margin-bottom:20px;">
                    <button class="btn btn-red" onclick="takeGun('–ü–ú', 16)">–í—ã–¥–∞—Ç—å –ü–ú</button>
                    <button class="btn btn-blue" onclick="takeGun('–ê–ö–°-74–£', 60)">–í—ã–¥–∞—Ç—å –ê–ö–°-74–£</button>
                    <button class="btn btn-outline" onclick="takeGun('–ë—Ä–æ–Ω–µ–∂–∏–ª–µ—Ç', 1)">–°–ò–ë–ó</button>
                </div>
                <h3>–ñ—É—Ä–Ω–∞–ª –≤—ã–¥–∞—á–∏</h3>
                <table class="table-w"><thead><tr><th>–í—Ä–µ–º—è</th><th>–°–æ—Ç—Ä—É–¥–Ω–∏–∫</th><th>–í–æ–æ—Ä—É–∂–µ–Ω–∏–µ</th></tr></thead>
                <tbody>${DB.armory.slice().reverse().map(a => `<tr><td>${a.time}</td><td>${a.user}</td><td>${a.item} (${a.ammo} –ø–∞—Ç—Ä.)</td></tr>`).join('')}</tbody></table></div>`;
            }
            else if(page === 'garage') {
                 v.innerHTML = `<div class="panel"><h2>–°–ª—É–∂–µ–±–Ω—ã–π –∞–≤—Ç–æ–ø–∞—Ä–∫</h2>
                 <table class="table-w"><thead><tr><th>–ì–æ—Å–Ω–æ–º–µ—Ä</th><th>–ê–≤—Ç–æ–º–æ–±–∏–ª—å</th><th>–°—Ç–∞—Ç—É—Å</th><th>–î–µ–π—Å—Ç–≤–∏–µ</th></tr></thead>
                 <tbody>${DB.garage.map((c, i) => `<tr>
                    <td><b>${c.num}</b></td><td>${c.car}</td>
                    <td><span class="status-badge ${c.status=='–°–≤–æ–±–æ–¥–µ–Ω'?'st-green':'st-red'}">${c.status}</span></td>
                    <td>${c.status=='–°–≤–æ–±–æ–¥–µ–Ω' ? `<button class="btn btn-blue" style="padding:4px" onclick="takeCar(${i})">–í–∑—è—Ç—å</button>` : `<button class="btn btn-outline" style="padding:4px" onclick="returnCar(${i})">–í–µ—Ä–Ω—É—Ç—å</button>`}</td>
                 </tr>`).join('')}</tbody></table></div>`;
            }
            else if(page === 'awards') {
                 v.innerHTML = `<div class="panel"><h2>–ù–∞–≥—Ä–∞–¥–Ω–æ–π –æ—Ç–¥–µ–ª</h2><p>–î–ª—è –Ω–∞–≥—Ä–∞–∂–¥–µ–Ω–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª "–õ–∏—á–Ω—ã–π —Å–æ—Å—Ç–∞–≤" –∏ –Ω–∞–∂–º–∏—Ç–µ "–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å", –∑–∞—Ç–µ–º –≤–ø–∏—à–∏—Ç–µ –Ω–∞–≥—Ä–∞–¥—É –≤—Ä—É—á–Ω—É—é.</p></div>`;
            }
        }

        // --- ACTIONS ---
        function regUser() {
            const fio = prompt("–§–ò–û –Ω–æ–≤–æ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞:");
            const pass = prompt("–ü–∞—Ä–æ–ª—å –¥–ª—è –≤—Ö–æ–¥–∞:");
            if(fio && pass) {
                DB.users.push({ id: Date.now(), fio: fio, pass: pass, rank: "–õ–µ–π—Ç–µ–Ω–∞–Ω—Ç —é—Å—Ç–∏—Ü–∏–∏", pos: "–°–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å", dept: "–û—Ç–¥–µ–ª –ø–æ —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—é –û–í–î", role: 1, medals: "" });
                sync(); go('staff');
            }
        }

        function editUser(id) {
            const u = DB.users.find(x => x.id === id);
            if(!u) return;
            document.getElementById('e-id').value = u.id;
            document.getElementById('e-fio').value = u.fio;
            document.getElementById('e-rank').value = u.rank;
            document.getElementById('e-pos').value = u.pos;
            document.getElementById('e-dept').value = u.dept;
            document.getElementById('e-medals').value = u.medals;
            document.getElementById('m-edit').style.display = 'flex';
        }

        function saveUser() {
            const id = parseInt(document.getElementById('e-id').value);
            const u = DB.users.find(x => x.id === id);
            if(u) {
                u.rank = document.getElementById('e-rank').value;
                u.pos = document.getElementById('e-pos').value;
                u.dept = document.getElementById('e-dept').value;
                u.medals = document.getElementById('e-medals').value;
                sync();
                document.getElementById('m-edit').style.display = 'none';
                go('staff');
            }
        }

        function delUser(id) {
            if(confirm("–í—ã —É–≤–µ—Ä–µ–Ω—ã? –°–æ—Ç—Ä—É–¥–Ω–∏–∫ –±—É–¥–µ—Ç —É–¥–∞–ª–µ–Ω –∏–∑ –±–∞–∑—ã.")) {
                DB.users = DB.users.filter(x => x.id !== id);
                sync(); go('staff');
            }
        }

        function closeM() { document.getElementById('m-edit').style.display = 'none'; }

        function addCase() {
            const art = prompt("–°—Ç–∞—Ç—å—è –£–ö –†–§:");
            const susp = prompt("–ü–æ–¥–æ–∑—Ä–µ–≤–∞–µ–º—ã–π:");
            if(art) {
                DB.cases.push({ num: Math.floor(100000 + Math.random() * 900000), article: art, suspect: susp || "–ù–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω", investigator: Me.fio, status: "–í–æ–∑–±—É–∂–¥–µ–Ω–æ" });
                sync(); go('cases');
            }
        }

        function takeGun(item, ammo) {
            DB.armory.push({ time: new Date().toLocaleTimeString(), user: Me.fio, item: item, ammo: ammo });
            sync(); go('armory');
        }

        function takeCar(idx) {
            DB.garage[idx].status = "–ó–ê–ù–Ø–¢ (" + Me.fio + ")"; sync(); go('garage');
        }
        function returnCar(idx) {
            DB.garage[idx].status = "–°–≤–æ–±–æ–¥–µ–Ω"; sync(); go('garage');
        }

    </script>
</body>
</html>